<meta charset="utf-8"/>
<title>Hand Note</title>
<script>

const maxSound = 5;
const minSound = 0;
const memSize = 250;

const sounds = [

  new Audio("noise/clap.mp3"),
  new Audio("noise/click.mp3"),
  new Audio("noise/crack.mp3"),
  new Audio("noise/punch.mp3"),
  new Audio("noise/scratch.mp3"),
  new Audio("noise/slap.mp3")
];

const registers = {
  
  stackPointers: [0];
  memoryPointer: 0;
  currentStack: 0;
  //duration: 0,
  volume: 0,
  sound: 0,
  a: 0,
  b: 0,
  
  setSound: (n) => this.sound = n > maxSound ? minSound : n < minSound ? maxSound : n;
  
  setVolume: (n) => this.volume = (n > 100 ? 100 : n < 0 ? 0 : n) / 100;
  getVolume: () => this.volume * 100;
  
  setMemoryPointer: (n) => this.memoryPointer = n > memSize ? memSize : n < 0 ? 0 : n;
  
  setStackPointer: (n) => this.stackPointers[currentStack] = n;
  getStackPointer: () => this.stackPointers[currentStack];
};

const memory = Array(memSize);
const instructionStack = [];

const glyphs = [
  
  "ğŸ‘‹", // play
  //"ğŸ¤", // store to duration
  "âœ‹", // end if/repeat
  "ğŸ‘Œ", // repeat
  "âœŒ", // store to volume
  "ğŸ¤˜", // store to sound type
  "ğŸ‘ˆ", // move + 1
  "ğŸ‘‰", // move - 1
  "ğŸ‘†", // increment
  "ğŸ‘‡", // decrement
  "ğŸ‘", // higher than
  "ğŸ‘", // lower than
  "âœŠ", // store to register a
  "ğŸ‘Š", // store to register b
  "ğŸ¤›", // from register a
  "ğŸ¤œ"  // from register b
];

const parse = (src, i = 0) => {

  const stack = [];
  const peek = () => i + 1 < src.length ? src[i + 1] : -1; 

  for (; i < src.length; ++i) {
  
    switch (src[i]) {
      
      case "ğŸ‘‹":
        
        stack.push(() => (
          
          sounds[registers.sound].volume = registers.getVolume();
          sounds[registers.sound].play();
        ));
        break;

      case "âœ‹":
        return {stack: stack, index: i};

      case "ğŸ‘Œ":
        
        const repeatStack = parse(src, i);
        
        break;

      case "âœŒ":
      
        break;

      case "ğŸ¤˜":
      
        break;

      case "ğŸ‘ˆ":
      
        break;

      case "ğŸ‘‰":
      
        break;

      case "ğŸ‘†":
      
        break;

      case "ğŸ‘‡":
      
        break;

      case "ğŸ‘":
      
        break;

      case "ğŸ‘":
      
        break;

      case "âœŠ":
      
        break;

      case "ğŸ‘Š":
      
        break;

      case "ğŸ¤›":
      
        break;

      case "ğŸ¤œ":
      
        break;
    }
  });
}
</script>